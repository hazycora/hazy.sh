{"type":"data","nodes":[{"type":"data","data":[null],"uses":{}},{"type":"data","data":[{"post":1,"html":12,"aside":13},{"frontmatter":2,"slug":8,"path":9,"date":10,"body":11},{"image":3,"imageAlt":4,"title":5,"description":6,"date":7},"/blog/twitter-summary-card-phishing/card-example.png","A Tweet displaying a summary card linking to discord.com","Twitter's cards have a bug that makes phishing easy","Sites linked to on Twitter can pretend to be any other URL","2023-06-03","twitter-summary-card-phishing","/blog/twitter-summary-card-phishing",["Date","2023-06-03T00:00:00.000Z"],"\n(I'm not the first to find this problem. It's been known since 2019, I link to other articles and blog posts that came before me at the end.)\n\nWhen you link to something at the end of a Tweet, the link isn't displayed. Instead, you'll only see a \"summary card\" Twitter generates when a post is made. The domain name of the URL is displayed in these cards, so at face value they don't make phishing easier.\n\n![A Tweet displaying a summary card linking to discord.com](/blog/twitter-summary-card-phishing/card-example-domain-highlighted.png)\n\n## their implementation is Not Perfect\n\nIf a link redirects to another page, Twitter follows that redirect and displays the domain name of the destination instead of the original URL. This is fine, it means the cards will reflect the same page users will see.\nBut the user isn't sent directly to the destination- When someone clicks one of these cards, they go to the original URL. For typical redirect links, that's okay, because the redirect Twitter experiences will we the same as the user's redirect. But what if a malicious site serves a different redirect to users than to Twitter?\n\nWhen Twitter fetches the page content in order to generate these cards, they set the HTTP \"User-Agent\" header to begin with \"Twitterbot/\", so it can be detected on our website that the request was for Twitter. Setting custom User-Agents for things like this is normal, it means sites can customise the text of embeds for specific sites if necessary or block Twitter from making these requests if desired, but for malicious sites it also allows us to exploit this issue reliably.\n\nHere's an example of an ExpressJS route that detects Twitter and redirects to discord.com, while redirecting to example.com for everyone else:\n\n```js\napp.get('/', (req, res, next) => {\n\tconst detectedTwitter = req.headers['user-agent']\n\t\t.toLowerCase()\n\t\t.startsWith('Twitterbot/')\n\n\tif (detectedTwitter) {\n\t\t// redirect to the page to be displayed on Twitter\n\t\tres.redirect('https://discord.com')\n\t\treturn\n\t}\n\n\t// handle request for other users\n\t// malicious sites could serve a phishing site right here\n\tres.redirect('https://example.com')\n})\n```\n\n![An animated GIF showing a Tweet that looks to contain a link to Discord, but sends users to example.com instead](/blog/twitter-summary-card-phishing/demo.gif)\n\n## this issue is old\n\nTwitter has had this issue for years, and I'm by no means the first to notice it. It's [been known since 2019](https://shkspr.mobi/blog/2019/03/scammers-abusing-twitter-cards-via-redirects/) at the latest. My friend [Lexi](https://twitter.com/1lexxi) found the same issue a couple years ago, and she told me it reported this to Twitter through HackerOne, but the exploit still hasn't been fixed.\n\n\u003Cdiv class=\"dm\">\n\u003Cblockquote>\n\ntwitters bbp is a joke, fixing things is not their strong suit\n\n\u003C/blockquote>\n\u003Cdiv>\n\nLmao\n\n\u003C/div>\n\u003C/div>\n\nBleepingComputer [wrote on this in 2019](https://www.bleepingcomputer.com/news/security/twitter-can-be-tricked-into-showing-misleading-embedded-links/) and contacted Twitter about it, to no response.\n\n> BleepingComputer reached out to Twitter for a statement about this problem and if it would be fixed in the near future but received no reply at the time of publishing.\n\nHopefully Twitter realises the severity of this problem. Be careful when clicking links- the suggestion to check URLs before clicking is a good one, but it's not infallible!\n","\n\u003Cp>(I’m not the first to find this problem. It’s been known since 2019, I link to other articles and blog posts that came before me at the end.)\u003C/p>\n\u003Cp>When you link to something at the end of a Tweet, the link isn’t displayed. Instead, you’ll only see a “summary card” Twitter generates when a post is made. The domain name of the URL is displayed in these cards, so at face value they don’t make phishing easier.\u003C/p>\n\u003Cp>\u003Cimg\n  src=\"/blog/twitter-summary-card-phishing/card-example-domain-highlighted.png\"\n  alt=\"A Tweet displaying a summary card linking to discord.com\"\n>\u003C/p>\n\u003Ch2>their implementation is Not Perfect\u003C/h2>\n\u003Cp>If a link redirects to another page, Twitter follows that redirect and displays the domain name of the destination instead of the original URL. This is fine, it means the cards will reflect the same page users will see.\nBut the user isn’t sent directly to the destination- When someone clicks one of these cards, they go to the original URL. For typical redirect links, that’s okay, because the redirect Twitter experiences will we the same as the user’s redirect. But what if a malicious site serves a different redirect to users than to Twitter?\u003C/p>\n\u003Cp>When Twitter fetches the page content in order to generate these cards, they set the HTTP “User-Agent” header to begin with “Twitterbot/”, so it can be detected on our website that the request was for Twitter. Setting custom User-Agents for things like this is normal, it means sites can customise the text of embeds for specific sites if necessary or block Twitter from making these requests if desired, but for malicious sites it also allows us to exploit this issue reliably.\u003C/p>\n\u003Cp>Here’s an example of an ExpressJS route that detects Twitter and redirects to discord.com, while redirecting to example.com for everyone else:\u003C/p>\n\u003Cpre class=\"shiki shiki-themes hazycore\" style=\"background-color:#090514;color:#bbbbbb\" tabindex=\"0\">\u003Ccode lang=\"js\">\u003Cspan class=\"line\">\u003Cspan style=\"color:#8BC7FF\">app\u003C/span>\u003Cspan style=\"color:#E8E8FF\">.\u003C/span>\u003Cspan style=\"color:#B3FFCD\">get\u003C/span>\u003Cspan style=\"color:#e4b3f0\">(\u003C/span>\u003Cspan style=\"color:#F7A9D5\">'/'\u003C/span>\u003Cspan style=\"color:#E8E8FF\">, \u003C/span>\u003Cspan style=\"color:#b3a3ee\">(\u003C/span>\u003Cspan style=\"color:#8BC7FF\">req\u003C/span>\u003Cspan style=\"color:#E8E8FF\">, \u003C/span>\u003Cspan style=\"color:#8BC7FF\">res\u003C/span>\u003Cspan style=\"color:#E8E8FF\">, \u003C/span>\u003Cspan style=\"color:#8BC7FF\">next\u003C/span>\u003Cspan style=\"color:#b3a3ee\">)\u003C/span>\u003Cspan style=\"color:#E8E8FF\"> \u003C/span>\u003Cspan style=\"color:#CAAEFF\">=\u003C/span>\u003Cspan style=\"color:#CAAEFF\">>\u003C/span>\u003Cspan style=\"color:#E8E8FF\"> \u003C/span>\u003Cspan style=\"color:#b3a3ee\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#CAAEFF\">\tconst\u003C/span>\u003Cspan style=\"color:#8BC7FF\"> detectedTwitter\u003C/span>\u003Cspan style=\"color:#E8E8FF\"> = \u003C/span>\u003Cspan style=\"color:#8BC7FF\">req\u003C/span>\u003Cspan style=\"color:#E8E8FF\">.\u003C/span>\u003Cspan style=\"color:#8BC7FF\">headers\u003C/span>\u003Cspan style=\"color:#9fe6f3\">[\u003C/span>\u003Cspan style=\"color:#F7A9D5\">'user-agent'\u003C/span>\u003Cspan style=\"color:#9fe6f3\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E8E8FF\">\t\t.\u003C/span>\u003Cspan style=\"color:#B3FFCD\">toLowerCase\u003C/span>\u003Cspan style=\"color:#9fe6f3\">(\u003C/span>\u003Cspan style=\"color:#9fe6f3\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E8E8FF\">\t\t.\u003C/span>\u003Cspan style=\"color:#B3FFCD\">startsWith\u003C/span>\u003Cspan style=\"color:#9fe6f3\">(\u003C/span>\u003Cspan style=\"color:#F7A9D5\">'Twitterbot/'\u003C/span>\u003Cspan style=\"color:#9fe6f3\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#CAAEFF\">\tif\u003C/span>\u003Cspan style=\"color:#E8E8FF\"> \u003C/span>\u003Cspan style=\"color:#9fe6f3\">(\u003C/span>\u003Cspan style=\"color:#8BC7FF\">detectedTwitter\u003C/span>\u003Cspan style=\"color:#9fe6f3\">)\u003C/span>\u003Cspan style=\"color:#E8E8FF\"> \u003C/span>\u003Cspan style=\"color:#9fe6f3\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C7C7FF72;font-style:italic\">\t\t// redirect to the page to be displayed on Twitter\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#8BC7FF\">\t\tres\u003C/span>\u003Cspan style=\"color:#E8E8FF\">.\u003C/span>\u003Cspan style=\"color:#B3FFCD\">redirect\u003C/span>\u003Cspan style=\"color:#9ff0ac\">(\u003C/span>\u003Cspan style=\"color:#F7A9D5\">'https://discord.com'\u003C/span>\u003Cspan style=\"color:#9ff0ac\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#CAAEFF\">\t\treturn\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E8E8FF\">\t\u003C/span>\u003Cspan style=\"color:#9fe6f3\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C7C7FF72;font-style:italic\">\t// handle request for other users\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C7C7FF72;font-style:italic\">\t// malicious sites could serve a phishing site right here\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#8BC7FF\">\tres\u003C/span>\u003Cspan style=\"color:#E8E8FF\">.\u003C/span>\u003Cspan style=\"color:#B3FFCD\">redirect\u003C/span>\u003Cspan style=\"color:#9fe6f3\">(\u003C/span>\u003Cspan style=\"color:#F7A9D5\">'https://example.com'\u003C/span>\u003Cspan style=\"color:#9fe6f3\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#b3a3ee\">}\u003C/span>\u003Cspan style=\"color:#e4b3f0\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg\n  src=\"/blog/twitter-summary-card-phishing/demo.gif\"\n  alt=\"An animated GIF showing a Tweet that looks to contain a link to Discord, but sends users to example.com instead\"\n>\u003C/p>\n\u003Ch2>this issue is old\u003C/h2>\n\u003Cp>Twitter has had this issue for years, and I’m by no means the first to notice it. It’s \u003Ca\n  href=\"https://shkspr.mobi/blog/2019/03/scammers-abusing-twitter-cards-via-redirects/\"\n  rel=\"nofollow\"\n>been known since 2019\u003C/a> at the latest. My friend \u003Ca\n  href=\"https://twitter.com/1lexxi\"\n  rel=\"nofollow\"\n>Lexi\u003C/a> found the same issue a couple years ago, and she told me it reported this to Twitter through HackerOne, but the exploit still hasn’t been fixed.\u003C/p>\n\u003Cdiv class=\"dm\">\n\u003Cblockquote>\n\u003Cp>twitters bbp is a joke, fixing things is not their strong suit\u003C/p>\n\u003C/blockquote>\n\u003Cdiv>\n\u003Cp>Lmao\u003C/p>\n\u003C/div>\n\u003C/div>\n\u003Cp>BleepingComputer \u003Ca\n  href=\"https://www.bleepingcomputer.com/news/security/twitter-can-be-tricked-into-showing-misleading-embedded-links/\"\n  rel=\"nofollow\"\n>wrote on this in 2019\u003C/a> and contacted Twitter about it, to no response.\u003C/p>\n\u003Cblockquote>\n\u003Cp>BleepingComputer reached out to Twitter for a statement about this problem and if it would be fixed in the near future but received no reply at the time of publishing.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Hopefully Twitter realises the severity of this problem. Be careful when clicking links- the suggestion to check URLs before clicking is a good one, but it’s not infallible!\u003C/p>\n",[14,22,30,39],{"frontmatter":15,"slug":19,"path":20,"date":21},{"title":16,"description":17,"date":18},"Webfishing's bizarre profanity filter","Canadians are being CENSORED by the adorable furry fishing game","2024-11-11","webfishings-silly-filter","/blog/webfishings-silly-filter",["Date","2024-11-11T00:00:00.000Z"],{"frontmatter":23,"slug":27,"path":28,"date":29},{"title":24,"description":25,"date":26},"I kinda just don’t care what the OSI thinks","My projects are open for the greater good, not for military, policing, or bigots","2024-05-03","i-dont-care-what-the-osi-thinks","/blog/i-dont-care-what-the-osi-thinks",["Date","2024-05-03T00:00:00.000Z"],{"frontmatter":31,"slug":36,"path":37,"date":38},{"title":32,"description":33,"date":34,"contentWarning":35},"Bypassing YouTube Content-ID with flashing frames","Uploading copyrighted content to YouTube at the cost of epileptic seizures","2023-05-03","Flashing lights","bypassing-content-id","/blog/bypassing-content-id",["Date","2023-05-03T00:00:00.000Z"],{"frontmatter":40,"slug":44,"path":45,"date":46},{"title":41,"description":42,"date":43},"Downloading YouTube subscriptions in CSV format with web scraping","Because Google Takeout takes too long","2022-05-23","download-youtube-subscriptions","/blog/download-youtube-subscriptions",["Date","2022-05-23T00:00:00.000Z"]],"uses":{"params":["slug"]}}]}
